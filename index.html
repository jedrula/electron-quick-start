<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <!-- TODO is it safe ? -->
<!--     <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'">
    <meta http-equiv="X-Content-Security-Policy" content="default-src 'self'; script-src 'self'"> -->
    <title>Electron Audio</title>

    <style>
      button {
        width: 150px;
        height: 50px;
      }

      input[type="range"] {
        margin-top: 10px;
      }

      .radio-container + .radio-container {
        margin-top: 10px;
      }
    </style>
  </head>
  <!-- https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_custom_elements -->
  <body>

    <div class="radio-container">
      <button
        onclick="postRequest('http://localhost:4000/audio/nowy-swiat/play')"
      >
        Nowy Swiat
      </button>
      <button
        onclick="postRequest('http://localhost:4000/audio/nowy-swiat/pause')"
      >
        Pause
      </button>
      <input type="range" min="0" max="1" value="1" step="any" id="volume-nowy-swiat" onchange="sendVolume(this.value, 'nowy-swiat')">
    </div>

    <div class="radio-container">
      <button
        onclick="postRequest('http://localhost:4000/audio/antyradio/play')"
      >
        Antyradio
      </button>
      <button
        onclick="postRequest('http://localhost:4000/audio/antyradio/pause')"
      >
        Pause
      </button>
      <input type="range" min="0" max="1" value="1" step="any" id="volume-antyradio" onchange="sendVolume(this.value, 'antyradio')">
    </div>

    <div class="radio-container">
      <button
        onclick="postRequest('http://localhost:4000/audio/ram/play')"
      >
        Ram
      </button>
      <button
        onclick="postRequest('http://localhost:4000/audio/ram/pause')"
      >
        Pause
      </button>
      <input type="range" min="0" max="1" value="1" step="any" id="volume-ram" onchange="sendVolume(this.value, 'ram')">
    </div>

    <button
      style="margin-top: 20px"
      onclick="postRequest('http://localhost:4000/refresh')"
    >
      Refresh
    </button>

    <!-- You can also require other files to run in this process -->
    <script src="./renderer.js"></script>

    <script type="text/javascript">
      function sendVolume(value, radio) {
        postRequest(`http://localhost:4000/audio/${radio}/volume`, { value: parseFloat(value) })
      }
      async function setInitialVolume() {
        document.querySelector('#volume-nowy-swiat').value = (await getRequest('http://localhost:4000/audio/nowy-swiat/volume')).value;
        document.querySelector('#volume-antyradio').value = (await getRequest('http://localhost:4000/audio/antyradio/volume')).value;
        document.querySelector('#volume-ram').value = (await getRequest('http://localhost:4000/audio/ram/volume')).value;
      }
      setInitialVolume();

    </script>
  </body>
</html>
