<html>
  <style>
    button {
      width: 150px;
      height: 50px;
    }

    input[type="range"] {
      margin-top: 10px;
    }

    .radio-container + .radio-container {
      margin-top: 10px;
    }
  </style>
  <script src="./global.js"></script>
  <div class="radio-container">
    <button
      onclick="postRequest('audio/nowy-swiat/play')"
    >
      Nowy Swiat
    </button>
    <button
      onclick="postRequest('audio/nowy-swiat/pause')"
    >
      Pause
    </button>
    <input type="range" min="0" max="1" value="1" step="any" id="volume-nowy-swiat" onchange="sendVolume(this.value, 'nowy-swiat')">
  </div>

  <div class="radio-container">
    <button
      onclick="postRequest('audio/ram/play')"
    >
      Ram
    </button>
    <button
      onclick="postRequest('audio/ram/pause')"
    >
      Pause
    </button>
    <input type="range" min="0" max="1" value="1" step="any" id="volume-ram" onchange="sendVolume(this.value, 'ram')">
  </div>

  <div class="radio-container">
    <button
      onclick="postRequest('audio/antyradio/play')"
    >
      Antyradio
    </button>
    <button
      onclick="postRequest('audio/antyradio/pause')"
    >
      Pause
    </button>
    <input type="range" min="0" max="1" value="1" step="any" id="volume-antyradio" onchange="sendVolume(this.value, 'antyradio')">
  </div>
  <!-- TODO refresh remote when raspberry electron refreshes -->
  <button
    style="margin-top: 20px"
    onclick="postRequest('refresh')"
  >
    Refresh
  </button>
</html>
<script>
async function postRequest(url, data = {}) {
  const response = await fetch(`http://${window.localIp}:4000/${url}`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(data)
  });
  return response.json();
}

async function getRequest(url) {
  const response = await fetch(`http://${window.localIp}:4000/${url}`, {
    method: 'GET',
    headers: {
      'Content-Type': 'application/json',
    },
  });
  return response.json();
}

function sendVolume(value, radio) {
  postRequest(`audio/${radio}/volume`, { value: parseFloat(value) })
}
async function setInitialVolume() {
  document.querySelector('#volume-nowy-swiat').value = (await getRequest('audio/nowy-swiat/volume')).value;
  document.querySelector('#volume-antyradio').value = (await getRequest('audio/antyradio/volume')).value;
  document.querySelector('#volume-ram').value = (await getRequest('audio/ram/volume')).value;
}
setInitialVolume();
</script>